## 레디스 기본 개념
3장에서는 레디스 자료구조에 대해 전반적으로 쭉 소개하는 것으로 이해했습니다.
요약 위주보단, 관련있는 사례 및 포스팅 읽으면서 느낀점과 의문 정리하는 방식으로 해볼게요.

---

### 사이드프로젝트에서 레디스 조작 사례
- **상황**

모카콩 사이드프로젝트에서, 운영 환경에 있는 특정 카페의 리뷰 데이터를 삭제해야 되는 요구사항이 주어졌습니다.

- **접근방법**

운영 환경이긴 하지만, 트래픽이 많지 않으며 올바르지 않은 테스트용 데이터가 들어간 상황이었습니다. 이에 따라 직접 해당 cafe의 review 데이터를 `delete` 쿼리로 삭제해주었습니다.

- **문제**

해당 데이터를 delete 쿼리로 삭제 후 commit했음에도 불구하고, 앱에서 **해당 카페의 리뷰 데이터가 미리보기로 계속 잘 조회되는 현상**이 발생했습니다.

- **문제 해결 접근 방법**

`keys *` 명령어는 키 전체 조회하므로 느린 성능을 가집니다. 이에 따라 `scan 0` 명령어로 캐시 데이터를 조회했으나, 리뷰 관련 캐시가 조회되지 않아 캐시데이터가 없는 것으로 판단**했었습**니다.
<img width="484" alt="image" src="https://github.com/TReKa-Genius-Library/redis-for-developer/assets/57135043/f26ad65b-8811-41ce-92a3-b8f10d533496">
들뜬 바보...

하지만, 혹시 몰라 `keys *` 명령어로 전체 조회를 해보았고 약 200개 정도의 캐시데이터가 조회됐습니다.
(200개 정도 조회하는 데 걸린 시간은 0.1초가 채 안되는 것으로 확인)
진작 `keys *` 명령어를 써볼걸 그랬네요.

🧑🏻‍🔧 여기서 의문! 그렇다면 `keys *` 명령어는 캐시 데이터가 몇 건정도 있어야 느린걸까요? 
🧑🏻‍🔧 여기서 의문2! 데이터가 엄청나게 많을 때는 `exists`와 같이 존재성 여부만 검사하거나, `keys [prefix]*`와 같이 접두사를 붙여서 조회할까요? 혹시 관련 경험 있으면 공유받고 싶습니다!


- **원인**

keys 명령어로 조회해보니, cafePreviewCache 데이터가 캐시에 남아있어서 캐시데이터를 바로 반환하는 현상 때문이었습니다. 캐시를 고려하지 못하고 RDBMS 내의 데이터만 삭제한 것이죠.
<img width="784" alt="image" src="https://github.com/TReKa-Genius-Library/redis-for-developer/assets/57135043/a6f87c7d-9b71-40b3-9edf-985d4f3832f8">

- 해결방법

`del` 명령어로 삭제해주었습니다~
<img width="482" alt="image" src="https://github.com/TReKa-Genius-Library/redis-for-developer/assets/57135043/37ffd338-0e59-4b5a-a6bf-fed80e7e2a45">

---

### 여기어때 - Redis&Kafka를 활용한 선착순 쿠폰 이벤트 개발기 (feat. 네고왕)
관련 글: https://techblog.gccompany.co.kr/redis-kafka%EB%A5%BC-%ED%99%9C%EC%9A%A9%ED%95%9C-%EC%84%A0%EC%B0%A9%EC%88%9C-%EC%BF%A0%ED%8F%B0-%EC%9D%B4%EB%B2%A4%ED%8A%B8-%EA%B0%9C%EB%B0%9C%EA%B8%B0-feat-%EB%84%A4%EA%B3%A0%EC%99%95-ec6682e39731


